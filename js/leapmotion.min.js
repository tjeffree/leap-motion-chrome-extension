function leapMotionChromeExtension(){}
(function(){function L(){window.addEventListener("resize",function(){A=window.innerWidth;B=window.innerHeight},!1);window.addEventListener("focus",function(){n=!0});window.addEventListener("blur",function(){n=!1})}function M(a,c){function f(){b.stop||((new Date).getTime()-d>=c&&(a.call(),d=(new Date).getTime()),b.value=requestAnimationFrame(f))}var d=(new Date).getTime(),b={stop:!1};b.value=requestAnimationFrame(f);return b}function C(a){a.stop=!0;window.cancelAnimationFrame(a.value)}function D(){if(m.fingers===
t){var a=document.createElement("div"),c=document.createElement("div"),f,b;a.id="chrome-leap-fingercontainer";for(b=0;10>b;b++)f=c.cloneNode(),f.id="chrome-leap-finger"+(b+1),"rainbow"===m.color&&(f.style.cssText="background-color: "+N[b]+";"),f.className="chrome-leap-finger chrome-leap-finger-"+m.color,a.appendChild(f);g=document.createElement("div");h=document.createElement("div");g.id="chrome-leap-scroll-down";h.id="chrome-leap-scroll-up";a.appendChild(g);a.appendChild(h);document.body.appendChild(a);
k=document.getElementsByClassName("chrome-leap-finger");g=document.getElementById("chrome-leap-scroll-down");h=document.getElementById("chrome-leap-scroll-up")}u=M(O,1E3)}function O(){v?(P(),Q()):C(u)}function P(){E=Date.now()/1E3;if(null!==w&&E-w>R)if(10>x)x++,console.log("Disconnected from Leap Motion - attempting reconnect ("+x+"/10)"),F();else{C(u);v=!1;try{"runtime"in chrome?chrome.runtime.sendMessage({connection:"lost"},function(a){console.error("Connection to Leap Motion Lost. Restart Leap Motion and Refresh Page.");
var b=document.createElement("div");b.className="leap_motion_connection";b.innerHTML="<b>ATTENTION:</b> Connection to Leap Motion Lost. Restart Leap Motion and Refresh Page.";document.body.appendChild(b);document.getElementsByClassName("leap_motion_connection")[0].addEventListener("click",function(){this.style.display="none"},!1);setTimeout(function(){b.parentNode.removeChild(b)},2E4)}):console.error("Connection to Leap Motion Lost. Restart Leap Motion and Refresh Page.")}catch(a){console.error(a.message)}}}
function Q(){if("runtime"in chrome)try{chrome.runtime.sendMessage({tab_status:"current"},function(a){n=a.active&&window.location.href==a.url&&document.hasFocus()?!0:!1})}catch(a){-1!==a.message.indexOf("Error connecting to extension")?refresh_page():console.error(a.message)}else n=document.hasFocus()}function G(){if(m.fingers===t&&(g.style.display="none",h.style.display="none",void 0!==k[0]))for(var a=0;10>a;a++)k[a].style.opacity=0}function S(a,c){if(m.scrolling!==H&&void 0!==c.pointablesMap&&0!==
a.pointableIds.length&&void 0!==c.pointablesMap[a.pointableIds[0]]&&"direction"in c.pointablesMap[a.pointableIds[0]]){var b,d=T;b=new y(c.finger(a.pointableIds[0]).direction);a.isClockwise=b.angleTo(new y(a.normal))<=Math.PI/4;null==e||a.isClockwise!==e.isClockwise||a.id!==e.id?e=a:(30>a.radius&&(d/=1.5),35<a.radius&&(d*=2.5),b=10*(a.progress-e.progress)*d,100<b||0>=b?e=a:(clearTimeout(I),p=a.pointableIds[0],a.isClockwise?q="down":(b=-b,q="up"),window.scrollBy(0,b,"smooth"),e="stop"===a.state?null:
a,I=setTimeout(function(){p=q=null;g.style.display="none";h.style.display="none"},200)))}}function U(a,b){0===a.handIds.length||(!z||m.history===H)||100>Math.abs(a.position[0]-a.startPosition[1])||(0<a.direction[0]?history.forward():history.back(),z=!1,setTimeout(function(){z=!0},300))}function J(){"storage"in chrome?chrome.storage.local.get(["leap_motion_fingers","leap_motion_color","leap_motion_scrolling","leap_motion_history"],function(a){for(var b in a)if("undefined"!==typeof a[b]){var f=b.substr(b.lastIndexOf("_")+
1);m[f]=a[b]}D()}):D()}function F(){void 0!==l&&("connected"in l&&l.connected)&&(l.disconnect(),l=null);l=new Leap.Controller({enableGestures:!0});l.on("frame",function(){var a=l.frame(0);if(v){var c;w=Date.now()/1E3;if("yes"===m.fingers&&n){if(c=0<a.hands.length&&"undefined"!==a.hands[0]._scaleFactor?a.hands[0]._scaleFactor:1,!K&&(G(),c=Math.ceil(b*c),Math.ceil(c/2),void 0!==k[0]&&0<a.fingers.length)){c=0;for(var f=a.fingers.length,d,e;c<f&&10>c;c++)if(null===p||p===a.fingers[c].id)d=A/2+a.fingers[c].tipPosition[0],
e=B/2-a.fingers[c].tipPosition[1],k[c].style.top="0",k[c].style.left="0",k[c].style.transform="translate3d("+d.toFixed(2)+"px, "+e.toFixed(2)+"px, 0)",k[c].style.webkitTransform="translate3d("+d.toFixed(2)+"px, "+e.toFixed(2)+"px, 0)",k[c].style.opacity=0.5,p===a.fingers[c].id&&("down"===q?(g.style.transform="translate3d("+d.toFixed(2)+"px, "+(e+b+5)+"px, 0)",g.style.webkitTransform="translate3d("+d.toFixed(2)+"px, "+(e+b+5)+"px, 0)",g.style.display="block",g.style.borderTopColor=k[c].style.backgroundColor):
"up"===q?(h.style.transform="translate3d("+d.toFixed(2)+"px, "+(e-b+5)+"px, 0)",h.style.webkitTransform="translate3d("+d.toFixed(2)+"px, "+(e-b+5)+"px, 0)",h.style.display="block",h.style.borderBottomColor=k[c].style.backgroundColor):(g.style.display="none",h.style.display="none"))}}else K||G();if(void 0!==a.pointables&&n){if(r=a.gestures&&0<a.gestures.length?"gesture":null,null!==r)switch(r){case "gesture":c=a.gestures[0];if("circle"===c.type){S(c,a);break}"swipe"===c.type&&"stop"===c.state&&U(c,
a)}}else r=null}});l.connect()}function y(a){null==a?this.z=this.y=this.x=0:"x"in a?(this.x=a.x,this.y=a.y,this.z=a.z):"0"in a&&(this.x="number"==typeof a[0]?a[0]:0,this.y="number"==typeof a[1]?a[1]:0,this.z="number"==typeof a[2]?a[2]:0)}var H="disabled",t="yes",n=!1,v=!0,r=null,x=0,E,w=null,u,R=5,A=window.innerWidth,B=window.innerHeight,T=15,q=null,I=null,p=null,z=!0,b=20,N="#F80C12 #FF3311 #FF6644 #FEAE2D #D0C310 #69D025 #12BDB9 #4444DD #3B0CBD #442299".split(" "),k=[],K=!1,g,h,e=null,s,l,m={fingers:t,
color:"rainbow",scrolling:"enabled",history:"enabled"},V=".leap_motion_connection {position: fixed;top: 0;left: 0;width: 100%;color: #222;text-align: center;height: 30px;z-index: 1000;line-height: 30px;background-color: #9AC847; }.chrome-leap-finger {width:"+b+"px;height:"+b+"px;-webkit-border-radius: "+Math.ceil(b/2)+"px;border-radius: "+Math.ceil(b/2)+"px;position: fixed;z-index: 10000;opacity: 0;-webkit-transition: opacity 0.15s ease;transition: opacity 0.15s ease;-webkit-box-sizing: border-box;box-sizing: border-box;transform: translate3d(0,0,0); }.chrome-leap-finger-rainbow {-webkit-box-shadow: inset 0px 0px 1px 1px rgba(0, 0, 0, 0.25);box-shadow: inset 0px 0px 1px 1px rgba(0, 0, 0, 0.25); }.chrome-leap-finger-leap {background-color: #9AC847;-webkit-box-shadow: inset 0 0 5px #000;box-shadow: inner 0 0 5px #000; }.chrome-leap-finger-dark {background-color: #000000;-webkit-box-shadow: inset 0px 0px 1px 1px rgba(255, 255, 255, 0.5);box-shadow: inset 0px 0px 1px 1px rgba(255, 255, 255, 0.5); }.chrome-leap-finger-light {background-color: #FFFFFF;-webkit-box-shadow: inset 0px 0px 1px 1px rgba(0, 0, 0, 0.25);box-shadow: inset 0px 0px 1px 1px rgba(0, 0, 0, 0.25) }#chrome-leap-scroll-up {display: none; position: fixed; top:0; left:0;width: 0; height: 0;opacity: 0.5;margin-left: "+
b/2/2+"px;border-left: "+b/2/2+"px solid transparent;border-right: "+b/2/2+"px solid transparent;border-bottom: "+b/2+"px solid #9AC847; }#chrome-leap-scroll-down {display: none; position: fixed; top:0; left:0;width: 0; height: 0;opacity: 0.5;margin-left: "+b/2/2+"px;border-left: "+b/2/2+"px solid transparent;border-right: "+b/2/2+"px solid transparent;border-top: "+b/2+"px solid #9AC847; }";this.init=function(){s=document.createElement("style");s.setAttribute("type","text/css");s.appendChild(document.createTextNode(V));
document.head.appendChild(s);J();"storage"in chrome&&chrome.storage.onChanged.addListener(J);L();F()};y.prototype={angleTo:function(a){var b=this.magnitude()*a.magnitude();return 0<b?Math.acos(this.dot(a)/b):0},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},magnitude:function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2))}}}).apply(leapMotionChromeExtension);leapMotionChromeExtension.init();